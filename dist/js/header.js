"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}window.onload=function(){$.ajax({type:"post",url:"/ifloaded",dataType:"json",success:function(t){t.loaded&&($(".load>li:eq(0)").html("<a >你好，".concat(decodeURI(Cookie.get("name")),"</a>")),$(".load>li:eq(1)").html('<a href="./login.html">注销</a>'),$(".load>li:eq(1)>a").click(function(){$.ajax({type:"post",url:"/cancel",dataType:"json",success:function(t){console.log(t)}}),alert("已注销该账户，请重新登录！")}))}});var e=function(){function e(t){_classCallCheck(this,e),this.data=t}return _createClass(e,[{key:"init",value:function(){this.createElements(),this.onMouse2BannerNav(),this.onMouse2NAvDetail(),this.onMouse2Shop()}},{key:"createElements",value:function(){this.createNav(),this.createBannerNav(),this.createNAvDetail()}},{key:"createNav",value:function(){$(".header-nav>ul").eq(0).html(this.data.map(function(t){return' <li><a href="#">'.concat(t.title,"</a></li>")}))}},{key:"createBannerNav",value:function(){var t=this.data[0].detail.map(function(t){var e=Math.ceil(t.product.length/6),i=t.product.map(function(t){return'<a href="#">\n                        <img src='.concat(t.img," />\n                        <span>").concat(t.name,"</span>\n                    </a>")}).join("");return'<li>\n                    <a href="#">'.concat(t.type,'<i class="iconfont icon-jiantou"></i></a>\n                    <div class="detail" style="width:').concat(248*e,'px">\n                        ').concat(i,"\n                    </div>\n                </li>")});$(".header-nav>ul>li:eq(0)").append($("<ul class='banner-nav'></ul>").html(t))}},{key:"onMouse2BannerNav",value:function(){$(".banner-nav>li").hover(function(){$(this).children(".detail").css("display","flex")},function(){$(this).children(".detail").css("display","none")})}},{key:"createNAvDetail",value:function(){this.data.shift();var t=this.data.map(function(t){if(t.product){var e=t.product.map(function(t){return'<li data-name="'.concat(t.name,'">\n                        <a href="#">\n                            <img src=').concat(t.img,">\n                            <p>").concat(t.name,'</p>\n                            <p class="price">').concat(t.price,"</p>\n                        </a>\n                    </li>")}).join("");return'<ul class="con">\n                                '.concat(e,"\n                            </ul>")}});$(".nav-detail").html(t)}},{key:"onMouse2NAvDetail",value:function(){var t=this;$(".header-nav>ul>li").hover(function(){t.index=$(this).index()-1,$(this).index()<8&&0<$(this).index()&&($(".nav-detail ul").eq($(this).index()-1).toggle(),$(".nav-detail").stop().slideToggle(300))}),$(".nav-detail").hover(function(){t.index<7&&-1<t.index&&($(".nav-detail ul").eq(t.index).toggle(),$(this).stop().slideToggle(300))})}},{key:"onMouse2Shop",value:function(){$(".load div").hover(function(){$(this).children("p").css("color","#000"),$(this).children("p").stop().slideToggle()})}}]),e}(),i=function(){function e(t){_classCallCheck(this,e),this.data=t}return _createClass(e,[{key:"init",value:function(){this.createElements()}},{key:"createElements",value:function(){var t=this.data.map(function(t){return"<li>".concat(t,"</li>")});$(".search-box").html(t)}}]),e}();$.ajax({type:"get",async:!0,url:"../lib/data/data.json",dataType:"json",success:function(t){new e(t).init(),$(".nav-detail>ul").on("click","li",function(){var t={};t.name=$(this).data("name"),t.src=$(this).find("img")[0].src,t.price=$(this).find("p.price").html(),localStorage.setItem("item_info",JSON.stringify(t)),location.href="../pages/detail.html"})}}),$.ajax({async:!0,type:"get",url:"../lib/data/data2.json",dataType:"json",success:function(t){new i(t).init()}});var o=!0,c="手机",l=0,s=[],r="";function d(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"手机",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"asc";c=n;var a={};a=2==(l=e)?{query:n,page_index:t,page_size:20,filter_tag:0,main_sort:e,sort_by:i,province_id:20,city_id:233,classIndex:0}:{query:n,page_index:t,page_size:20,filter_tag:0,main_sort:e,province_id:20,city_id:233,classIndex:0},$.ajax({type:"get",url:"/xm",data:a,dataType:"jsonp",success:function(t){var e,i,a;console.log(t),t.data&&(s=t.data.pc_list,t.data.pc_list?(i=t.data.pc_list,a=$.map(i,function(t){var e="";return e=t.commodity_list[0].price==t.commodity_list[0].market_price?"".concat(t.commodity_list[0].price,"元"):"".concat(t.commodity_list[0].price,"元\n            <del>").concat(t.commodity_list[0].market_price,"</del>"),"<li data-productid=".concat(t.commodity_list[0].product_id,">\n                <img\n                    src=").concat(t.commodity_list[0].image,'\n                    alt=""\n                />\n                <h2>').concat(t.commodity_list[0].name,"</h2>\n                <p>").concat(e,"\n                 </p>\n            </li>")}).join(""),$(".goodsList>ul").html(a),o&&(e=Math.ceil(t.data.total/20),console.log("binpagi"),o=!1,$(".M-box3").pagination&&$(".M-box3").pagination({pageCount:e,jump:!0,coping:!0,homePage:"首页",endPage:"末页",prevContent:"<",nextContent:">",callback:function(t){console.log(1111111),d(c,t.getCurrent(),l,r)}}))):$(".goodsList").html("抱歉！没有找到与“".concat(n,"”相关的物品")))}})}$("input[type=submit]").click(function(t){o=!0,t.preventDefault(),-1!=location.href.indexOf("list")?""==$(this).prev().val()?d():d($(this).prev().val()):location.href="../pages/list.html?search="+$(this).prev().val()}),$(".search-box").on("click","li",function(){-1!=location.href.indexOf("list")?d($(this).text()):location.href="../pages/list.html?search="+$(this).text()}),$(".hot").on("click","span",function(){-1!=location.href.indexOf("list")?d($(this).text()):location.href="../pages/list.html?search="+$(this).text()}),$(".banner-nav").on("click","a",function(t){o=!0,t.preventDefault(),-1!=location.href.indexOf("list")?d($(this).text().trim()):location.href="../pages/list.html?search="+$(this).text().trim()}),$(".header-nav>ul").on("click","a",function(t){t.preventDefault(),console.log(this),o=!0,t.preventDefault(),-1!=location.href.indexOf("list")?d($(this).text().trim()):location.href="../pages/list.html?search="+$(this).text().trim()}),""==(c=decodeURI(location.search.substr(1).split("=")[1]))?d():d(c),$(".goodsList ul").on("click","li",function(){for(var t=0,e=s.length;t<e;t++)if(s[t].commodity_list[0].product_id==$(this).data("productid")){console.log(s[t].commodity_list[0]);var i={};i.name=s[t].commodity_list[0].name,i.src=s[t].commodity_list[0].image,s[t].commodity_list[0].price==s[t].commodity_list[0].market_price?i.price=s[t].commodity_list[0].price:i.price=" <span>".concat(s[t].commodity_list[0].price,"</span>元<del>").concat(s[t].commodity_list[0].market_price,"</del>"),i.detail=s[t].commodity_list[0].desc,localStorage.setItem("item_info",JSON.stringify(i)),location.href="../pages/detail.html";break}}),$(".filter ul").on("click","li",function(){switch($(this).addClass("active").siblings().removeClass("active"),$(this).text()){case"新品":l=4;break;case"销量":l=1;break;case"价格↑":l=2,r="dsc",$(this).text("价格↓");break;case"价格↓":l=2,r="asc",$(this).text("价格↑");break;default:l=0}console.log(c,1,l,r),d(c,1,l,r)})};